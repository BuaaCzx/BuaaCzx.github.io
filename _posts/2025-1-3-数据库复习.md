---
layout: post
title: 2024秋 数据库 理论复习
categories: [期末复习, 数据库]
tags: [数据库, 期末复习]
slug: database_final
description: 2024秋 数据库系统原理
---

## 1 概述

### 发展过程

人工管理→文件系统→数据库系统（集成的、共享的）

特点：

- **数据结构化**：数据库与文件系统的根本区别，描述数据之间的联系
- 数据独立性：物理独立性、逻辑独立性。提供 **映像（转换）** 功能
- 数据冗余度小
- 最小存取单位：数据项

### 集成数据的表示

#### 概念模型（E-R 法）

- 实体
- 属性
- 码（Key）
- 域（Domain）
- 实体型：表示一类实体
- 联系：实体型之间的联系，是实体之间的相互关联。
  - 名称
  - 类型：一对一，一对多，多对多
  - 可以具有属性

**E-R 图**：

- 实体（长方形）
- 属性（椭圆形）
- 联系（菱形）

<img src="./../images/2025-1-3-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%8D%E4%B9%A0/image-20250103135054059.png" alt="image-20250103135054059" style="zoom:50%;" />

#### 数据模型

**三要素**：

- 数据结构

  由描述数据对象以及对象之间联系的一组概念组成。包括描述 **对象** 的类型、内容、性质的概念，和 **对象之间联系** 的概念（如关系）。是数据 **静态特性** 的表述。

- 数据操作

  对数据库中各数据对象的 **实例** 允许执行的操作集合，包括 **操作和操作规则**。是数据 **动态特性** 的表述，主要有 **检索和更新** 两大类操作。

- 数据的约束条件

  完整性规则：数据和联系的所有制约规则。

**数据模型分类**：

- 层次模型（树结构，有向树，节点表示实体型，连线表示一对多联系）
- 网状模型（图结构，有向图，节点表示实体型，连线表示一对多联系）
- 关系模型（二维表，要求关系中每个分量是不可分的数据项）

### 系统结构

**数据独立性**：应用程序与数据结构之间相互独立。即使数据库逻辑结构变化，程序可以不变。

数据库系统体系结构特征：三级模式、两级映像（模式、外模式、内模式、两级映像）

<img src="./../images/2025-1-3-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%8D%E4%B9%A0/image-20250103141256484.png" alt="image-20250103141256484" style="zoom:50%;" />

**模式**：数据库中数据的逻辑结构和特性的描述，是所有用户的公共数据视图。**三级模式的核心**，不涉及数据物理存储细节，与具体的应用程序无关

**外模式**：某个用户或应用的数据视图，与某一应用有关的逻辑表示

**内模式**：存储模式，数据在数据库系统内部的表示，描述数据的物理结构和存储方式

**两级映像**：某个模式改变，改变映像即可，可以避免其他模式的修改。

- 逻辑独立性：模式改变，外模式可以不变（外模式与模式分开）
- 物理独立性：内模式改变，模式可以不变（模式与内模式分开）

**DBMS**：数据库系统的 **核心软件**，在操作系统支持下工作

## 2 关系数据库

### 概念与性质

概念：域、元组、分量、笛卡尔积

关系：笛卡尔积 $D_1 \times D_2 \times ... \times D_n$ 的 **子集** 叫做在域 $D_1, D_2, ..., D_n$ 上的关系，用 $R(D_1, D_2, ..., D_n)$ 表示。$R$ 是关系的名字，$n$ 是关系的度。

关系可以用二维表表示，每一行是一个元组，每一列是一个域，每个列附加一个名称称为“属性”，属性的名字是唯一的。

性质：

- 列是 **同质的**，每一列中的分量来自于同一个域，是同类型数据
- 不同的列可以来自于同一个域，但每个列的属性名不同
- 列次序和行次序都可以互换
- 每个分量必须是 **不可再分的数据**，满足这一条件的关系称作满足第一范式（1NF）的

### 关系模型

- **基本概念**

    码（Key，键）

    - 候选码：关系中的某一个 **属性组** 唯一标识一个元组，并具有 **最小性**（去掉其中某个属性，就不能唯一标识元组），则称这个属性组为候选码
    - 主码：如果有多个候选码，选其中一个为主码

    主属性：码中的各个属性称为主属性。

- **关系模式**

  关系 $R(U, D, dom, F)$

  - $U$：属性名的集合
  - $D$：域的集合
  - $dom$：属性名向域的映射（每个属性对应一个域）
  - $F$：属性间相互依赖关系集合

  关系模式是稳定的，相当于关系数据库的型；关系是动态的，相当于关系数据库的值。

- 关系模型的 **语义约束**

  - **实体完整性**：必须有主码，且主码值不可以为空。即主属性不能为空。

  - **参照完整性**：参照关系的外部码对应的元组值一定可以在目标关系中找到对应的值。

    - 外部码（外键）

      关系 R 的一个非码的属性组 F 是关系 S 的主码，那么 F 是 R 的外部码，R 为参照关系， S 为被参照关系或目标关系。R 和 S 不一定是不同的关系。

      目标关系的主码和参照关系的外部码必须定义在同一个域上。

- 关系数据的操作方式：**集合操作**。操作的基础：**关系运算**。关系运算方式：代数方式（关系代数），逻辑方式（关系演算：元组关系演算，域关系演算）。

    - **关系代数**（传统集合运算）

      除笛卡尔积外，要求运算的两个关系是 **同类关系**，即度相同，且对应的属性值的域也要相同。

      - 交、并、差

        同集合运算。

      - 广义笛卡尔积

        $R \times S$ 的集合是：前 $n$ 个分量是 $R$ 中的元组，后 $m$ 个分量是 $S$ 中的元组。

      - 选取

        在关系 $R$ 中选取满足给定条件 $F$ 的元组。

        $\sigma_F(R) = \{ t \mid t \in R, F(t) = '真' \}$

      - 投影

        在关系 $R(U)$ 中选取若干列 $A$，删除这些列里重复的行，得到新的关系。

        $\Pi_A(R) = \{ t[A] \mid t \in R, A \subseteq U \}$

      - 连接

        选取连接属性 $X, Y$，在 $R \times S$ 中选取出 $X$ 和 $Y$ 的值进行比较，满足比较条件 $\theta$ 的所有元组。
        
        $R \underset{X \theta Y}{\bowtie} S = \{ t \mid t = \langle r, s \rangle \land r \in R \land s \in S \land r[X] \ \theta \ s[Y] \}$
        
      - 自然连接
        
        在 $R，S$ 中找到相同的属性列 $X,Y$，然后以 $X,Y$ 为连接属性，比较关系 $\theta$ 取 $=$ 做连接，并去除重复的列。
        
        $R \bowtie S = \{ (Z, X, W) \mid (Z, X) \in R \land (W, X) \in S \land r[X] = s[X] \}$
        
      - 除法
      
        考虑 $R(X,Y)$，$S(Z)$，如果属性集 $Y$ 和 $Z$ 相同，那么 $R$ 除以 $S$ 是 $R$ 在 $X$ 上投影的子集，子集和 $S(Z)$ 的笛卡尔积包含于 $R(X,Y)$。
      
        $R \div S = \{ t \mid t \in \Pi_X(R) \land s \in S \land \langle t, s \rangle \in R \}$
      
    - **元组关系演算**
    
      基本结构是 **元组演算表达式**。
    
      元组关系表达式的形式定义：$\{ t \mid \Phi(t) \}$，表示了所有使 $\Phi$ 为真的元组的集合，即表示了一个关系。
    
    - **域关系演算**
    
      公式中的变量对应的是元组各个分量的域变量。
    
      域演算表达式的形式定义：$\{ (X_1, X_2, \dots, X_k) \mid \Phi(X_1, X_2, \dots, X_k) \}$，表示所有使 $\Phi$ 为真的那些 $(X_1, X_2, \dots, X_k)$ 组成的元组集合，即表达了一个关系。
    
- 关系运算的 **安全约束**

    **安全运算**：不产生无限关系和无穷验证的运算

    关系代数是安全运算，关系演算不一定是。对关系演算要进行安全约束。

    安全表达式：安全运算的运算表达式

    **安全约束**：对关系运算采取的限制。方法是对 $\Phi$ 定义一个有限的符号集 $DOM(\Phi)$，使 $\Phi$ 的运算结果及中间结果所产生的关系及其元组的各个分量都必须属于 $DOM(\Phi)$。即 $DOM(\Phi)$ 包括 $\Phi$ 中的所有常量和所有元组的所有分量值。 

    安全约束后，三种关系运算是等价的，可以互相转换。

### 关系数据语言

数据库数据语言分类：

- 数据定义语言DDL（Data definition language）：模式DDL，外模式DDL，内模式DDL
- 数据操纵语言DML（Data manipulation language）：四种基本操作（检索、插入、修改、删除），分为联机交互方式（自含式语言，可独立使用）和宿主语言方式（嵌入高级语言程序中）。
- 数据控制语言DCL（Data control language）：完成数据库的安全性控制、完整性控制、并发控制等。

关系数据语言的核心是查询，又称为 **查询语言**。关系运算是设计关系数据语言的基础，**关系运算的分类决定了关系语言的分类**。
