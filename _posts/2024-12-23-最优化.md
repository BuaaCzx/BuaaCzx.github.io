---
layout: post
title: 2024秋 最优化 期末复习
categories: [期末复习]
tags: [期末复习, 最优化]
slug: zuiyouhua
---

# 最优化

## 单纯形算法

### 等式形式的线性规划模型

对问题约束施加两个要求：

1. 都是等式，且右端项非负
2. 所有变量非负

解题过程：

1. 确定决策变量
2. 确定目标函数
3. 构造约束条件
4. 增加非负 **松弛变量**，必要时在方程两端乘 $-1$，把不等式转换为带有非负右端项的等式约束

最优解的候选解是 **有限个基本可行解**（对应图像上的一个角点）。

假设最后的方程组有 $m$ 个方程和 $n$ 个变量，每个基本可行解对应 $n-m$ 个变量为 $0$ 的一个解。这 $n-m$ 个零变量为 **非基变量**，剩下 $m$ 个变量为 **基变量**，它的解称为 **基本解**。

### 单纯形方法

考察所有角点中的一小部分，查找最优角点。

- 进基变量：进入基本可行解的变量

- 离基变量：离开基本可行解的变量

例子：
$$
\text{max} \quad z = 5x_1 + 4x_2 + 0s_1 + 0s_2 + 0s_3 + 0s_4
$$

$$
\text{s.t.} \quad 
\begin{aligned}
    & 6x_1 + 4x_2 + s_1 = 24 \\
    & x_1 + 2x_2 + s_2 = 6 \\
    & -x_1 + x_2 + s_3 = 1 \\
    & x_2 + s_4 = 2 \\
    & x_1, x_2, s_1, s_2, s_3, s_4 \geq 0
\end{aligned}
$$

初始单纯形表（画出表之后注意看一下目标方程所在行中，基变量对应的系数是否均为 $0$，如果不是，则要与对应的基变量行相加减，使它的系数为 $0$）：

<img src="./../images/2024-12-23-%E6%9C%80%E4%BC%98%E5%8C%96/image-20241223152607314.png" alt="image-20241223152607314" style="zoom:50%;" />

初始基本解为松弛变量，非基变量（不在基列中）总是等于 $0$。

1. **确定进基变量**：进基变量应为 **目标方程**（移项得到右项为零的等式）中具有 **最负系数** 的变量。（本来应该选最正的，但是移项之后系数变了，所以选最负的）（如果目标函数是求最小值，那就选最正系数）

2. **确定离基变量**：计算右端项（“解”）与进基变量下方的约束系数的 **非负比**，选取 **最小非负比** 的基变量为离基变量。
3. 令枢轴元素为 $1$，且除枢轴行外，枢轴列其它元素为 $0$（有点像高代的消元啥的）。
4. 重复寻找进基变量，直到目标方程没有负系数（求最小值则为正系数）为止。

### 改进单纯形方法

带有 $=$ 和 $\ge$ 约束：使用在最初迭代中扮演松弛变量角色的人工变量，然后在迭代中对他们进行处理。

#### 大 M 方法

如果第 $i$ 个等式约束和没有松弛变量，那么将人工变量 $R_i$ 加入到初始解中作为松弛变量充当初始基本解。

人工变量不是原始模型的一部分，因此需要在目标函数中对他们制定极高的惩罚，强迫他们在最优解中等于 $0$。

用一个“充分大的正数” $M$ 来构建人工变量的目标系数。

例子：
$$
\text{min} \quad z = 4x_1 + x_2
$$

$$
\text{s.t.} \quad 
\begin{aligned}
    & 3x_1 + x_2 = 3 \\
    & 4x_1 + 3x_2 \geq 6 \\
    & x_1 + 2x_2 \leq 4 \\
    & x_1, x_2 \geq 0
\end{aligned}
$$

先转换为等式形式：
$$
\text{min} \quad z = 4x_1 + x_2
$$

$$
\text{s.t.} \quad 
\begin{aligned}
    & 3x_1 + x_2 = 3 \\
    & 4x_1 + 3x_2 - x_3 = 6 \\
    & x_1 + 2x_2 + x_4 = 4 \\
    & x_1, x_2, x_3, x_4 \geq 0
\end{aligned}
$$

前两个方程没有松弛变量，增加人工变量 $R_1, R_2$，并修改目标函数。
$$
\text{min} \quad z = 4x_1 + x_2 + MR_1 + MR_2
$$

$$
\text{s.t.} \quad 
\begin{aligned}
    & 3x_1 + x_2 + R_1 = 3 \\
    & 4x_1 + 3x_2 - x_3 + R_2 = 6 \\
    & x_1 + 2x_2 + x_4 = 4 \\
    & x_1, x_2, x_3, x_4, R_1, R_2 \geq 0
\end{aligned}
$$

$M$ 相对于初始目标系数一定是充分大，迫使人工变量在最优解中取到 $0$。

得到初始表：

<img src="./../images/2024-12-23-%E6%9C%80%E4%BC%98%E5%8C%96/image-20241223155851933.png" alt="image-20241223155851933" style="zoom:50%;" />

注意到初始解为 $(R_1, R_2, x_4) = (3, 6, 4)$，$z$ 行结果与右端项不相等，主要是因为初始基变量在 $z$ 行有非零系数导致的。因此让 $z$ 行与相应的 $R_1, R_2$ 行进行加减，消去系数，最后用正常的单纯形方法求解即可。

如果没有可行解，最终的单纯形表将至少包含一个人工变量取正值。

问题：惩罚值 $M$ 需要很大，可能造成计算精度降低。

#### 两阶段法

分两个阶段求解：求初始基本可行解；求解原问题。

1. 阶段 1：将问题变成等式约束形式，并增加必要的人工变量。然后把问题转换为将 **人工变量之和最小化** 的问题（不管原问题是求极大还是极小，都求最小），得到这个问题的基本解以及和的最小值，如果和的最小值为正，无可行解，否则进行阶段 2。
2. 阶段 2：用阶段 1 得到的基本解作为初始可行解。

例子：

第一阶段开始，对于初始约束转换成的等式形式，先添加人工变量和松弛变量，尝试求解人工变量和的最小值：
$$
\text{min} \quad r = R_1 + R_2
$$

$$
\text{s.t.} \quad 
\begin{aligned}
    & 3x_1 + x_2 + R_1 = 3 \\
    & 4x_1 + 3x_2 - x_3 + R_2 = 6 \\
    & x_1 + 2x_2 + x_4 = 4 \\
    & x_1, x_2, x_3, x_4, R_1, R_2 \geq 0
\end{aligned}
$$

初始表：

<img src="./../images/2024-12-23-%E6%9C%80%E4%BC%98%E5%8C%96/image-20241223161927628.png" alt="image-20241223161927628" style="zoom:50%;" />

初始基变量在目标方程行有非零系数，这导致 $r$ 与右端项并不相同，需要先把初始基变量消去，得到正确的表，之后用单纯形方法求解这个问题，得到最终表格：

<img src="./../images/2024-12-23-%E6%9C%80%E4%BC%98%E5%8C%96/image-20241223162551936.png" alt="image-20241223162551936" style="zoom:50%;" />

产生基本可行解 $(x_1, x_2, x_4) = (3/5, 6/5, 1)$，去除人工变量列，转入阶段 2，得到阶段 2 的原始问题：
$$
\text{min} \quad z = 4x_1 + x_2
$$

$$
\text{s.t.} \quad 
\begin{aligned}
    & x_1 + \frac{1}{5}x_3 = \frac{3}{5} \\
    & x_2 - \frac{3}{5}x_3 = \frac{6}{5} \\
    & x_3 + x_4 = 1 \\
    & x_1, x_2, x_3, x_4 \geq 0
\end{aligned}
$$

初始表：

<img src="./../images/2024-12-23-%E6%9C%80%E4%BC%98%E5%8C%96/image-20241223163311433.png" alt="image-20241223163311433" style="zoom:50%;" />

初始基变量在目标方程行有非零系数，这导致 $r$ 与右端项并不相同，需要先把初始基变量消去，得到正确的表，之后用单纯形方法求解这个问题即可。

### 作业

#### 作业 1

$$
\text{max} \quad z = 2x_1 + 3x_2
$$

$$
\text{s.t.} \quad 
\begin{aligned}
    & x_1 + 2x_2 \leq 8 \\
    & 4x_1 \leq 16 \\
    & 4x_2 \leq 12 \\
    & x_1, x_2 \geq 0
\end{aligned}
$$

#### 作业 2

用两阶段方法求解：
$$
\text{min} \quad z = 4x_1 + x_2
$$

$$
\text{s.t.} \quad 
\begin{aligned}
    & 3x_1 + x_2 \leq 3 \\
    & 4x_1 + 3x_2 \geq 6 \\
    & x_1 + 2x_2 \leq 4 \\
    & x_1, x_2 \geq 0
\end{aligned}
$$